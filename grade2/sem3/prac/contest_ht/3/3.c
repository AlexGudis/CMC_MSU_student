#include <stdio.h>
#include <stdint.h>

const unsigned char crctable[] = {
    0,   29,  58,   39,   116,  105,  78,   83,   -24,  -11,  -46, -49, -100, -127, -90, -69, -51,  -48,  -9,   -22,
    -71, -92, -125, -98,  37,   56,   31,   2,    81,   76,   107, 118, -121, -102, -67, -96, -13,  -18,  -55,  -44,
    111, 114, 85,   72,   27,   6,    33,   60,   74,   87,   112, 109, 62,   35,   4,   25,  -94,  -65,  -104, -123,
    -42, -53, -20,  -15,  19,   14,   41,   52,   103,  122,  93,  64,  -5,   -26,  -63, -36, -113, -110, -75,  -88,
    -34, -61, -28,  -7,   -86,  -73,  -112, -115, 54,   43,   12,  17,  66,   95,   120, 101, -108, -119, -82,  -77,
    -32, -3,  -38,  -57,  124,  97,   70,   91,   8,    21,   50,  47,  89,   68,   99,  126, 45,   48,   23,   10,
    -79, -84, -117, -106, -59,  -40,  -1,   -30,  38,   59,   28,  1,   82,   79,   104, 117, -50,  -45,  -12,  -23,
    -70, -89, -128, -99,  -21,  -10,  -47,  -52,  -97,  -126, -91, -72, 3,    30,   57,  36,  119,  106,  77,   80,
    -95, -68, -101, -122, -43,  -56,  -17,  -14,  73,   84,   115, 110, 61,   32,   7,   26,  108,  113,  86,   75,
    24,  5,   34,   63,   -124, -103, -66,  -93,  -16,  -19,  -54, -41, 53,   40,   15,  18,  65,   92,   123,  102,
    -35, -64, -25,  -6,   -87,  -76,  -109, -114, -8,   -27,  -62, -33, -116, -111, -74, -85, 16,   13,   42,   55,
    100, 121, 94,   67,   -78,  -81,  -120, -107, -58,  -37,  -4,  -31, 90,   71,   96,  125, 46,   51,   20,   9,
    127, 98,  69,   88,   11,   22,   49,   44,   -105, -118, -83, -80, -29,  -2,   -39, -60};

uint8_t
compute_crc8(uint8_t *data, size_t size)
{

    char crc = 0;
    for (int i = 0; i < size; ++i) {
        /* XOR-in next input byte */
        unsigned char info = (char) (data[i] ^ crc);
        /* get current CRC value = remainder */
        crc = (char) (crctable[info]);
    }

    return crc;
}
